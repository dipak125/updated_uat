(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[13],{1320:function(e,a,t){"use strict";t.r(a);var l=t(11),n=t(13),r=t(14),c=t(46),m=t(18),o=t(17),i=t(0),s=t.n(i),d=t(903),u=t(904),p=t(913),E=t(377),y=t(48),g=t.n(y),f=t(2),h=t(31),v=t(34),_=t(40),b=t(7),N=t(38),S=t(19),H=t(22),w=t(1),k=t(9),P=t(37),D=t.n(P),O=t(61),M=t(20),R=t.n(M),j=t(3),I=t.n(j),q=t(97),T={gateway:""},C=w.object().shape({refNo:w.string().notRequired("Reference number is required").matches(/^[a-zA-Z0-9]*$/,(function(){return"Please enter valid reference number"}))}),B=function(e){Object(m.a)(i,e);var a=Object(o.a)(i);function i(e){var t,r;return Object(n.a)(this,i),(r=a.call(this,e)).additionalDetails=function(e){r.props.history.push("/Additional_detailsOD/".concat(e))},r.handleSubmit=function(e){var a=r.state,t=a.refNumber,l=a.policyHolder,n=a.activePolicy,c=a.request_data,m=r.props.match.params.productId;Math.floor(I()(n.end_date).diff(c.end_date,"days",!0))>=0?Object(q.b)(e,l,t,m):R()("Kindly connect with nearest branch for Policy Issuance")},r.fetchData=function(){r.props.match.params.productId;var e=r.state.policyHolder_refNo?r.state.policyHolder_refNo:"0",a=new k.a;b.a.get("four-wh-stal/policy-holder/motor-saod/".concat(e)).then((function(e){var t=JSON.parse(a.decrypt(e.data));console.log("decrypt-------------- ",t);var l=t.data.policyHolder?t.data.policyHolder.motorinsurance:{},n=t.data.policyHolder?t.data.policyHolder:[],c=t.data.policyHolder?t.data.policyHolder.vehiclebrandmodel:{},m=t.data.policyHolder&&t.data.policyHolder.previouspolicyforsaod&&2==t.data.policyHolder.previouspolicyforsaod.length?t.data.policyHolder.previouspolicyforsaod[1]:{},o=t.data.policyHolder&&t.data.policyHolder.previouspolicyforsaod&&2==t.data.policyHolder.previouspolicyforsaod.length?t.data.policyHolder.previouspolicyforsaod[0]:{},i=t.data.policyHolder?t.data.policyHolder.request_data:{},s=t.data.policyHolder?t.data.policyHolder.step_no:"",d=t.data.policyHolder?t.data.policyHolder.bcmaster:{},u=t.data.policyHolder?t.data.policyHolder.menumaster:{},p=t.data.policyHolder&&t.data.policyHolder.bcmaster&&t.data.policyHolder.bcmaster.bcpayment;r.setState({motorInsurance:l,policyHolder:n,vehicleDetails:c,previousPolicy:m,activePolicy:o,request_data:i,menumaster:u,step_completed:s,bcMaster:d,paymentgateway:p,refNumber:t.data.policyHolder.reference_no,paymentStatus:t.data.policyHolder.payment?t.data.policyHolder.payment[0]:[],memberdetails:t.data.policyHolder?t.data.policyHolder:[],nomineedetails:t.data.policyHolder?t.data.policyHolder.request_data.nominee[0]:[]}),r.fullQuote(l)})).catch((function(e){r.props.loadingStop()}))},r.fetchRequestData=function(){var e=r.state.policyHolder_refNo?r.state.policyHolder_refNo:"0",a=new k.a;b.a.get("four-wh-stal/policy-holder/motor-saod/".concat(e)).then((function(e){var t=JSON.parse(a.decrypt(e.data)),l=t.data.policyHolder?t.data.policyHolder.request_data:{};r.setState({request_data:l})})).catch((function(e){r.props.loadingStop()}))},r.callBreakin=function(e){for(var a=new FormData,t=new k.a,l=e,n=l.length,c="",m=l.substring(0,1),o=0;o<=14;o++)m=c+l.substring(o,o+1),c=Object(q.d)(m,n);var i=r.state.policyHolder_refNo?r.state.policyHolder_refNo:"0",s=sessionStorage.getItem("bcLoginData")?sessionStorage.getItem("bcLoginData"):"";s&&(s=JSON.parse(t.decrypt(s))),a.append("bcmaster_id",sessionStorage.getItem("csc_id")?"5":s?s.agent_id:""),a.append("ref_no",i),a.append("registrationNo",c),a.append("page_name","PremiumOD/".concat(r.props.match.params.productId)),r.props.loadingStart(),b.a.post("breakin/create",a).then((function(e){0==e.data.error?(R()("Your breakin request has been raised. Your inspection Number: ".concat(e.data.data.inspection_no)),r.props.loadingStop()):(R()(e.data.msg),r.props.loadingStop())})).catch((function(e){r.props.loadingStop()}))},r.fullQuote=function(e){var a=new FormData,t=new k.a,l=0,n=e&&e.policytype_id?e.policytype_id:"",c=r.state,m=c.previousPolicy,o=c.request_data,i=c.policyHolder,s={reference_no:r.state.policyHolder_refNo?r.state.policyHolder_refNo:"0",idv_value:e.idv_value,policy_type:e.policy_type,add_more_coverage:e.add_more_coverage,coverage_data:e&&null!=e.add_more_coverage_request_json?e.add_more_coverage_request_json:"",cng_kit:e.cng_kit,cngKit_Cost:Math.floor(e.cngkit_cost),PA_Cover:e&&e.pa_cover?e.pa_cover:"0"};console.log("post_data--fullQuotePMCAR------- ",s),a.append("enc_data",t.encrypt(JSON.stringify(s))),b.a.post("four-wh-stal/fullQuoteStlM4W",a).then((function(a){if(a.data.PolicyObject&&a.data.UnderwritingResult&&"Success"==a.data.UnderwritingResult.Status?r.setState({fulQuoteResp:a.data.PolicyObject,PolicyArray:a.data.PolicyObject.PolicyLobList,error:[]}):r.setState({fulQuoteResp:[],error:a.data}),r.props.loadingStop(),m&&"Vehicle Recommended and Reports Uploaded"!=i.break_in_status||"3"==n&&"Vehicle Recommended and Reports Uploaded"!=i.break_in_status){l=m?Math.floor(I()().diff(m.end_date,"days",!0)):"";m&&m.name;if(l>0||"3"==n||e&&0==e.valid_previous_policy){var t=new FormData,c=r.state.policyHolder_refNo?r.state.policyHolder_refNo:"0";t.append("policy_ref_no",c),b.a.post("breakin/checking",t).then((function(a){var t=a.data.data.break_in_checking,l=a.data.data.break_in_inspection_no,n=a.data.data.break_in_status;1==t&&(r.setState({breakin_flag:1}),""!=l||null!=n&&"0"!=n?R()({title:"Breakin",text:"Breakin already raised. \nBreaking number ".concat(l,"."),icon:"warning"}):R()({title:"Breakin",text:"Your Quotation number is ".concat(o.quote_id,". Your vehicle needs inspection. Do you want to raise inspection."),icon:"warning",buttons:!0,dangerMode:!0}).then((function(a){a?r.callBreakin(e&&e.registration_no):r.props.loadingStop()})))})).catch((function(e){r.setState({breakin_flag:1}),r.props.loadingStop()}))}}r.fetchRequestData()})).catch((function(e){r.setState({serverResponse:[]}),r.props.loadingStop()}))},r.fetchRelationships=function(){r.props.loadingStart(),b.a.get("relations").then((function(e){var a=e.data.data?e.data.data:[];r.setState({relation:a}),r.fetchData()})).catch((function(e){r.props.loadingStop(),r.setState({relation:[]})}))},r.sendPaymentLink=function(){new k.a;var e=new FormData,a=localStorage.getItem("policyHolder_refNo")?localStorage.getItem("policyHolder_refNo"):0;e.append("reference_no",a),r.props.loadingStart(),b.a.post("send-payment-link",e).then((function(e){R()(e.data.msg),r.props.loadingStop()})).catch((function(e){r.props.loadingStop()}))},r.handleClose=r.handleClose.bind(Object(c.a)(r)),r.state=(t={show:!1,refNo:"",whatsapp:"",fulQuoteResp:[],motorInsurance:[],error:[],purchaseData:[],error1:[],refNumber:"",paymentStatus:[],accessToken:"",PolicyArray:[],memberdetails:[],nomineedetails:[],relation:[],policyHolder:[],step_completed:"0",vehicleDetails:[],previousPolicy:[],request_data:[],breakin_flag:0},Object(l.a)(t,"request_data",[]),Object(l.a)(t,"menumaster",[]),Object(l.a)(t,"paymentgateway",[]),Object(l.a)(t,"policyHolder_refNo",D.a.parse(r.props.location.search).access_id?D.a.parse(r.props.location.search).access_id:localStorage.getItem("policyHolder_refNo")),t),r}return Object(r.a)(i,[{key:"handleClose",value:function(e){this.setState({show:!1})}},{key:"changePlaceHoldClassAdd",value:function(e){e.target.parentElement.classList.add("active")}},{key:"changePlaceHoldClassRemove",value:function(e){var a=e.target.parentElement;0===e.target.value.length&&a.classList.remove("active")}},{key:"componentDidMount",value:function(){this.fetchRelationships()}},{key:"render",value:function(){var e=this,a=this.state,l=(a.policyHolder,a.show,a.fulQuoteResp),n=a.motorInsurance,r=a.error,c=(a.error1,a.refNumber,a.paymentStatus),m=a.relation,o=a.memberdetails,i=a.nomineedetails,y=a.vehicleDetails,b=a.breakin_flag,N=a.request_data,S=a.bcMaster,H=(a.menumaster,a.paymentgateway),w=this.props.match.params.productId,k=localStorage.getItem("phrases")?JSON.parse(localStorage.getItem("phrases")):null,P=r&&r.message?s.a.createElement("span",{className:"errorMsg"},s.a.createElement("h6",null,s.a.createElement("strong",null,"Thank you for showing your interest for buying product.Due to some reasons, we are not able to issue the policy online.Please call 1800 22 1111"))):null,D=c&&103==c.transaction_status?s.a.createElement("span",{className:"errorMsg"},s.a.createElement("h6",null,s.a.createElement("strong",null,"Payment failed. Please try again"))):null;return s.a.createElement(s.a.Fragment,null,s.a.createElement(h.a,null,s.a.createElement("div",{className:"page-wrapper"},s.a.createElement("div",{className:"container-fluid"},s.a.createElement("div",{className:"row"},s.a.createElement("aside",{className:"left-sidebar"},s.a.createElement("div",{className:"scroll-sidebar ps-container ps-theme-default ps-active-y"},s.a.createElement(v.a,null))),s.a.createElement("div",{className:"col-sm-12 col-md-12 col-lg-12 col-xl-12 infobox odpremium"},s.a.createElement("h4",{className:"text-center mt-3 mb-3"},k.SBIGICL),s.a.createElement(f.e,{initialValues:T,onSubmit:this.handleSubmit,validationSchema:C},(function(a){var r=a.values,c=(a.errors,a.setFieldValue);a.setFieldTouched,a.isValid,a.isSubmitting,a.touched;return s.a.createElement(f.d,null,s.a.createElement("section",{className:"brand m-t-11 m-b-25"},s.a.createElement("div",{className:"d-flex justify-content-left"},s.a.createElement("div",{className:"brandhead m-b-10"},s.a.createElement("h4",null,k.PremiumDetails))),s.a.createElement("div",{className:"brandhead m-b-30"},s.a.createElement("h5",null,P),s.a.createElement("h5",null,D),s.a.createElement("h4",null,k.PolRefNumber," ",l.QuotationNo)),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:12,lg:9},s.a.createElement("div",{className:"rghtsideTrigr"},s.a.createElement(g.a,{trigger:k.PolicyDetails},s.a.createElement("div",{className:"listrghtsideTrigr"},s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"motopremium"},"Policy Start date:")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"premamount"},N&&N.start_date?I()(N.start_date).format("DD-MM-yyy"):null)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"motopremium"},"Policy End Date:")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"premamount"},N&&N.end_date?I()(N.end_date).format("DD-MM-yyy"):null)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"motopremium"},"Product Name:")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"premamount"},y&&y.vehicletype?y.vehicletype.description:null)))))),s.a.createElement("div",{className:"rghtsideTrigr"},s.a.createElement(g.a,{trigger:k.RMPolicy,open:!0},s.a.createElement("div",{className:"listrghtsideTrigr"},s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"motopremium"},k.Premium,":")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"premamount"},"\u20b9 ",l.DuePremium)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"motopremium"},k.GrossPremium,":")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"premamount"},"\u20b9 ",Math.round(l.BeforeVatPremium))),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"motopremium"},k.GST,":")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement("div",{className:"premamount"},"\u20b9 ",Math.round(l.TGST))))))),s.a.createElement("div",{className:"rghtsideTrigr m-b-30"},s.a.createElement(g.a,{trigger:k.VehicleDetails},s.a.createElement("div",{className:"listrghtsideTrigr"},o?s.a.createElement("div",null,s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:12},s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.RegNo,":")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,n&&n.registration_no))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.Brand,":")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,y&&y.vehiclebrand&&y.vehiclebrand.name?y.vehiclebrand.name:""))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.Model)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,y&&y.vehiclemodel&&y.vehiclemodel.description?y.vehiclemodel.description+" "+y.varientmodel.varient:""))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.Variant)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,y&&y.varientmodel&&y.varientmodel.varient?y.varientmodel.varient:""))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.ChasisNumber)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,n&&n.chasis_no?n.chasis_no:""))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.EngineNumber)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,n&&n.engine_no?n.engine_no:""))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.FuelType)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,y&&y.varientmodel&&y.varientmodel.fuel_type?O.a[parseInt(y.varientmodel.fuel_type)]:null))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.Seating)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,y&&y.varientmodel&&y.varientmodel.seating?y.varientmodel.seating:null))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.IDVofVehicle)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,n&&n.idv_value?n.idv_value:null))))),s.a.createElement(d.a,null,s.a.createElement("p",null))):s.a.createElement("p",null),s.a.createElement("div",null,s.a.createElement(d.a,null,s.a.createElement("p",null)))))),s.a.createElement("div",{className:"rghtsideTrigr m-b-30"},s.a.createElement(g.a,{trigger:k.MemberDetails},s.a.createElement("div",{className:"listrghtsideTrigr"},o?s.a.createElement("div",null,s.a.createElement("strong",null,k.OwnerDetails," :"),s.a.createElement("br",null),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:12},s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.Name,":")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,o.first_name))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.Age,":")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,o&&o.dob?Math.floor(I()().diff(o.dob,"years",!0)):null))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.MobileNo)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,o.mobile))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.EmailId)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,o.email_id))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.Gender)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,"m"==o.gender?"Male":"Female"))))),s.a.createElement(d.a,null,s.a.createElement("p",null))):s.a.createElement("p",null),s.a.createElement("div",null,n&&"1"==n.pa_flag?s.a.createElement("div",null,s.a.createElement("strong",null,k.NomineeDetails," :"),s.a.createElement("br",null),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:12},s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.Name,":")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,i.first_name))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.Age,":")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,i&&i.dob?Math.floor(I()().diff(i.dob,"years",!0)):null))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.ProposerRelation,":")),s.a.createElement(u.a,{sm:12,md:6},m.map((function(e,a){return e.id==i.relation_with?s.a.createElement(p.a,null,e.name):null})))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.Gender)),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,"m"==i.gender?"Male":"Female"))))),s.a.createElement(d.a,null,s.a.createElement("p",null))):null,i&&"1"==i.is_appointee&&"1"==n.pa_flag?s.a.createElement("div",null,s.a.createElement("strong",null,k.AppoDetails," :"),s.a.createElement("br",null),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:12},s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.Name,":")),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,i&&i.appointee_name?i.appointee_name:null))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,k.ProposerRelation,":")),s.a.createElement(u.a,{sm:12,md:6},i&&i.appointee_relation_with&&m.map((function(e,a){return e.id==i.appointee_relation_with?s.a.createElement(p.a,null,e.name):null})))))),s.a.createElement(d.a,null,s.a.createElement("p",null))):null)))),s.a.createElement(d.a,null,s.a.createElement(u.a,{sm:12,md:6}),s.a.createElement(u.a,{sm:12,md:6},s.a.createElement(p.a,null,s.a.createElement("div",{className:"paymntgatway"},k.SelectPayGateway,H&&H.length>0?H.map((function(e,a){return e.hasOwnProperty("paymentgateway")&&e.paymentgateway?s.a.createElement("div",null,s.a.createElement("label",{className:"customRadio3"},s.a.createElement(f.b,{type:"radio",name:"gateway",value:a+1,key:a,onChange:function(a){c("gateway",a.target.value),c("slug",e.paymentgateway.slug)},checked:r.gateway=="".concat(a+1)}),s.a.createElement("span",{className:"checkmark "}),s.a.createElement("span",{className:"fs-14"},e.paymentgateway.logo?s.a.createElement("img",{src:t(137)("./"+e.paymentgateway.logo),alt:""}):null))):null})):null)))),s.a.createElement(d.a,null,"\xa0"),s.a.createElement("div",{className:"d-flex justify-content-left resmb"},s.a.createElement(E.a,{className:"backBtn",type:"button",onClick:e.additionalDetails.bind(e,w)},"Back"),S&&1==S.eligible_for_payment_link&&0==b?s.a.createElement("div",null,s.a.createElement(E.a,{type:"button",className:"proceedBtn",onClick:e.sendPaymentLink.bind(e)},"  ",k.PaymentLink,"  "),"\xa0\xa0\xa0\xa0"):null,l.QuotationNo&&0==b&&""!=r.gateway?s.a.createElement(E.a,{type:"submit",className:"proceedBtn"},k.MakePayment):null)),s.a.createElement(u.a,{sm:12,md:3,lg:3},s.a.createElement("div",{className:"motrcar"},s.a.createElement("img",{src:t(171),alt:""}))))))}))),s.a.createElement(_.a,null))))))}}]),i}(i.Component);a.default=Object(N.g)(Object(H.b)((function(e){return{loading:e.loader.loading}}),(function(e){return{loadingStart:function(){return e(Object(S.a)())},loadingStop:function(){return e(Object(S.b)())}}}))(B))}}]);