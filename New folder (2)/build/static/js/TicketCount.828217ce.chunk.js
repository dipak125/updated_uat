(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[9],{1011:function(e,t,a){"use strict";a.r(t);var n=a(14),c=a(15),r=a(18),l=a(17),s=a(0),i=a.n(s),o=(a(31),a(375)),d=a(10),m=a(3),p=a.n(m),u=a(52),f=a.n(u),h=a(72),v=(a(34),a(903)),E=a(904),g=a(913),k=a(26),b=a(20),S=(a(948),a(2)),y=(a(40),a(1)),N=a(7),_=a(19),T=a.n(_),w=a(971),F=a.n(w),C=(a(986),y.object().shape({description:y.string().required("Issue Summery is required").min(5,(function(){return"Minimum 5 characters required"})).max(1e3,(function(){return"Characters limit exceeds 1000"})).matches(/^[A-Za-z0-9\s.,-]*$/,"Invalid characters"),fileSize:y.string().test("filesize",(function(){return"Max file size below 4MB"}),(function(e){return!(e&&e>4194304)}))})),D=function(e){Object(r.a)(s,e);var t=Object(l.a)(s);function s(){var e;Object(n.a)(this,s);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={helpMasterList:[],details:[]},e.getDetails=function(){var t=new FormData;t.append("ticket_id",e.props.ticketId),e.props.loadingStart(),N.a.post("help-ticket/post",t).then((function(t){e.setState({details:t.data.data}),e.props.loadingStop()})).catch((function(t){e.setState({details:[]}),e.props.loadingStop()}))},e.getCurrentStatus=function(t){var a=new FormData;a.append("ticket_id",t.ticketid_Internal),e.props.loadingStart(),N.a.post("help-ticket/incident-details",a).then((function(t){0==t.data.error?T()("Current Status: ".concat(t.data.data.currentStatus)).then((function(t){t&&e.props.updateViewTicket()})):e.props.updateViewTicket(),e.props.loadingStop()})).catch((function(t){e.props.loadingStop()}))},e.fileUpload=function(){var t=Object(h.a)(f.a.mark((function t(a,n,c){var r,l,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a[0]||""===a[0].name){t.next=13;break}if(r=a[0].size,c("fileSize"),n("fileSize",r),!(r<=4194304)){t.next=11;break}return l=a[0],s=a[0].name,t.next=9,e.setState({selectedFile:l,selectedFileName:s});case 9:t.next=13;break;case 11:return t.next=13,e.setState({selectedFile:"",selectedFileName:""});case 13:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),e.fileAttachment=function(t,a){var n=a.resetForm;if(e.props.loadingStart(),e.state.selectedFile){var c=new FormData;c.append("ticket_id",e.props.ticketId),c.append("attachment_file",e.state.selectedFile),c.append("fileName",e.state.selectedFileName),c.append("destination",1),N.a.post("help-ticket/file-move",c).then((function(a){var c="";if(!1===a.data.error){c=a.data.data.support_post_id;var r=new FormData;r.append("ticket_id",e.props.ticketId),r.append("destination",1),r.append("post_id",c),N.a.post("help-ticket/attachment",r).then((function(a){if(!1===a.data.error){e.setState({selectedFile:"",selectedFileName:""});var r=new FormData;r.append("ticket_id",e.props.ticketId),r.append("description",t.description),r.append("post_id",c),N.a.post("help-ticket/insert-post",r).then((function(t){console.log("Attach Upload",t),T()("Reply posted sucessfully "+"\nTicket No.  ".concat(t.data.data.ticket_no),{icon:"success"}).then((function(){e.props.loadingStop(),n(),e.props.updateViewTicket()}))})).catch((function(t){console.log("Attach fail",t),e.props.loadingStop()}))}}))}})).catch((function(t){console.log("Reply fail",t),e.props.loadingStop()}))}else{var r=new FormData;r.append("ticket_id",e.props.ticketId),r.append("description",t.description),N.a.post("help-ticket/insert-post",r).then((function(t){console.log("Attach Upload",t),T()("Reply posted sucessfully "+"\nTicket No.  ".concat(t.data.data.ticket_no),{icon:"success"}).then((function(){e.props.loadingStop(),n(),e.props.updateViewTicket()}))})).catch((function(t){console.log("Attach fail",t),e.props.loadingStop()}))}},e.ticketReopen=function(t,a){var n=a.resetForm,c=new FormData;c.append("ticket_id",e.props.ticketId),c.append("description",t.description),N.a.post("help-ticket/reopen-incident",c).then((function(t){0==t.data.error?T()("Ticket reopened sucessfully "+"\nTicket No.  ".concat(t.data.data.ticket_no),{icon:"success"}).then((function(){e.props.loadingStop(),n(),e.getCurrentStatus(e.props.selectedTicket)})):(T()(t.data.msg,{icon:"error"}),n(),e.getCurrentStatus(e.props.selectedTicket))})).catch((function(t){console.log("Attach fail",t),e.props.loadingStop()}))},e}return Object(c.a)(s,[{key:"changePlaceHoldClassAdd",value:function(e){e.target.parentElement.classList.add("active")}},{key:"changePlaceHoldClassRemove",value:function(e){var t=e.target.parentElement;0===e.target.value.length&&t.classList.remove("active")}},{key:"componentDidMount",value:function(){this.getDetails()}},{key:"render",value:function(){var e=this,t=this.state.details,n=this.props.selectedTicket,c="bc"==n.user_type?null==n.bcuser?n.bc_user_id:n.bcuser.user_name:n.csc_user.name;return console.log("userName--- ",n.bc_user),console.log("selectedTicket--- ",n),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:""},i.a.createElement("div",{className:"d-flex justify-content-left opntckt"},i.a.createElement("div",null,i.a.createElement("h2",null,i.a.createElement("strong",null,n.title)," #",this.props.selectedTicket.ticket_no))),i.a.createElement(S.e,{initialValues:{help_topic:"",description:"",status:n.status},validationSchema:C,onSubmit:"Resolved"==n.status?this.ticketReopen:this.fileAttachment},(function(r){var l=r.errors,s=(r.status,r.touched),o=(r.values,r.setFieldValue),d=r.setFieldTouched;return i.a.createElement(S.d,null,i.a.createElement("div",{className:"tootalTicketinfo"},i.a.createElement(v.a,null,i.a.createElement(E.a,{sm:12,md:6},i.a.createElement("h3",null,"Basic Ticket Information"),i.a.createElement("div",{className:"col-one"},i.a.createElement(v.a,null,i.a.createElement(E.a,{sm:12,md:3},i.a.createElement("div",{className:"first"},"Ticket Status:")),i.a.createElement(E.a,{sm:12,md:9},i.a.createElement("div",null,n.status))),i.a.createElement(v.a,null,i.a.createElement(E.a,{sm:12,md:3},i.a.createElement("div",null,"Area:")),i.a.createElement(E.a,{sm:12,md:9},i.a.createElement("div",null,n.area))),i.a.createElement(v.a,null,i.a.createElement(E.a,{sm:12,md:3},i.a.createElement("div",null,"Create Date:")),i.a.createElement(E.a,{sm:12,md:9},i.a.createElement("div",null,p()(n.created_at).format("DD/MM/YYYY hh:mm A")))))),i.a.createElement(E.a,{sm:12,md:6},i.a.createElement("h3",null,"User Information"),i.a.createElement("div",{className:"col-two"},i.a.createElement(v.a,null,i.a.createElement(E.a,{sm:12,md:3},i.a.createElement("div",{className:"first"},"Name:")),i.a.createElement(E.a,{sm:12,md:9},i.a.createElement("div",{className:"first"},c))),i.a.createElement(v.a,null,i.a.createElement(E.a,{sm:12,md:3},i.a.createElement("div",null,"Email:")),i.a.createElement(E.a,{sm:12,md:9},i.a.createElement("div",null,n.email))),i.a.createElement(v.a,null,i.a.createElement(E.a,{sm:12,md:3},i.a.createElement("div",null,"Phone:")),i.a.createElement(E.a,{sm:12,md:9},i.a.createElement("div",null,n.mobile))))))),i.a.createElement("div",{className:"tickeddetails"},i.a.createElement("h3",null,"Ticket Details"),i.a.createElement(v.a,null,i.a.createElement(E.a,{sm:12,md:3},i.a.createElement("div",null,"Module")),i.a.createElement(E.a,{sm:12,md:9},i.a.createElement("div",null,"DN")))),i.a.createElement("div",{className:"entry-message-area"},i.a.createElement("div",{className:"thread-entry message avatar"},i.a.createElement("span",{className:"avatar"},i.a.createElement("img",{className:"avatar",alt:"Avatar",src:"//www.gravatar.com/avatar/c4b67d2401af1361e3b91f250ebc5b1b?s=80&d=mm"}),"    "),i.a.createElement("div",{className:"header-panel"},i.a.createElement("div",{className:"header"},i.a.createElement("b",null,c)," posted ",i.a.createElement("span",null,p()(n.created_at).format("DD/MM/YYYY hh:mm A"))," ",i.a.createElement("span",{className:"title truncate"})),i.a.createElement("div",{className:"thread-body"},F()(n.description),i.a.createElement("div",{className:"clear"})))),i.a.createElement("div",{className:"thread-event"},i.a.createElement("span",{className:"type-icon"},i.a.createElement("img",{src:a(389),alt:""})),i.a.createElement("span",{className:"description"},"Created by ",i.a.createElement("b",null,"SYSTEM")," ",i.a.createElement("i",null,p()(n.created_at).format("DD/MM/YYYY hh:mm A"))))),t&&t.map((function(e,t){return i.a.createElement("div",{className:"entry-message-area"},i.a.createElement("div",{className:"thread-entry message avatar"},i.a.createElement("span",{className:"avatar"},i.a.createElement("img",{className:"avatar",alt:"Avatar",src:"//www.gravatar.com/avatar/c4b67d2401af1361e3b91f250ebc5b1b?s=80&d=mm"}),"    "),i.a.createElement("div",{className:"header-panel"},i.a.createElement("div",{className:"0"==e.is_solution?"1"==e.is_user_reply?"header":"header_reply":"header_solution"},i.a.createElement("b",null,e.name)," posted ",i.a.createElement("span",null,p()(e.created_at).format("DD/MM/YYYY hh:mm A"))," ",i.a.createElement("span",{className:"title truncate"})),i.a.createElement("div",{className:"thread-body"},F()(e.decriptions),i.a.createElement("div",{className:"clear"})))),null!=e.attachment_file_name?i.a.createElement("div",{className:"thread-event"},console.log(" row.attachment_file_name--- ",e.attachment_file_name),i.a.createElement("span",{className:"type-icon"},i.a.createElement("img",{src:a(389),alt:""})),i.a.createElement("span",{className:"description"},e.attachment_file_name," ")):null)})),"Closed"!=n.status?i.a.createElement("div",{className:"justify-content-left opntckt"},i.a.createElement("div",{className:"issueSummery"},i.a.createElement("div",{class:"form-group"},i.a.createElement("h4",null,"Post a Reply"),i.a.createElement("p",{className:"mandotory-field"},"To best assist you, we request that you be specific and detailed ",i.a.createElement("span",null,"*")),i.a.createElement(g.a,null,i.a.createElement(S.b,{name:"description",as:"textarea",rows:"8",className:"form-control"+(l.description&&s.description?" is-invalid":"")}),i.a.createElement(S.a,{name:"description",component:"div",className:"errorMsg"}))),"Resolved"!=n.status?i.a.createElement("div",{class:"form-group"},i.a.createElement("input",{type:"file",key:"1",name:"attachment",accept:".jpg,.jpeg,.png,.gif,.pdf,.doc,.docx,.key,.ppt,.pptx,.pps,.ppsx,.odt,.xls,.xlsx,.zip,.html,.bmp,.dib,.txt,.xml,.eml,.csv,.msg,.xps,.htm",onChange:function(t){t.target.value.length>0&&e.fileUpload(t.target.files,o,d)}}),l.fileSize&&s.fileSize?i.a.createElement("span",{className:"errorMsg"},l.fileSize):null):null),i.a.createElement("div",{className:"form-group"},"Resolved"!=n.status?i.a.createElement("button",{type:"submit",className:"btn btn-success mr-2"},"Post Reply"):null,"Resolved"==n.status?i.a.createElement("button",{type:"submit",className:"btn btn-success mr-2"},"Reopen"):null,i.a.createElement("button",{type:"reset",className:"btn btn-primary mr-2"},"Reset"),i.a.createElement("button",{className:"btn btn-info",onClick:e.props.updateViewTicket},"Cancel"))):i.a.createElement("div",{className:"form-group"},i.a.createElement("button",{className:"btn btn-info",onClick:e.props.updateViewTicket},"Back")))}))))}}]),s}(s.Component),x=Object(k.b)((function(e){return{loading:e.loader.loading}}),(function(e){return{loadingStart:function(){return e(Object(b.a)())},loadingStop:function(){return e(Object(b.b)())}}}))(D),I=a(920),j=a(918),Y=function(e){return function(t,a,n){return i.a.createElement(I.a,{tooltip:"Get Status",href:"#",clicked:function(){return e.getCurrentStatus(a)},id:"tooltip-1"},i.a.createElement(o.a,{type:"button"},"Get Status"))}},A=function(e){Object(r.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var c=arguments.length,r=new Array(c),l=0;l<c;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={ticketCount:[],ticketId:"",viewTicket:!1,selectedTicket:[]},e.getCurrentStatus=function(t){var a=new FormData;a.append("ticket_id",t.ticketid_Internal),e.props.loadingStart(),N.a.post("help-ticket/incident-details",a).then((function(t){0==t.data.error?T()("Status: ".concat(t.data.data.currentStatus)).then((function(t){t&&e.getTickets(1)})):e.getTickets(1),e.props.loadingStop()})).catch((function(t){e.props.loadingStop()}))},e.getTickets=function(t){var a=new FormData,n=new d.a;t=t||"1";var c="",r="",l="",s=sessionStorage.getItem("users")?JSON.parse(sessionStorage.getItem("users")):"";if(s&&(s=JSON.parse(n.decrypt(s.user))),"4"==s.login_type){var i=sessionStorage.getItem("bcLoginData")?sessionStorage.getItem("bcLoginData"):"";i&&(i=JSON.parse(n.decrypt(i))),c=sessionStorage.getItem("csc_id")?"csc":"bc",r=sessionStorage.getItem("csc_id")?"5":i?i.agent_id:"0",l=sessionStorage.getItem("csc_id")?sessionStorage.getItem("csc_id"):i?i.user_info.data.user.username:""}else c=s.user_type,r=s.bc_master_id,l=s.master_user_id;a.append("user_type",c),a.append("master_id",r),a.append("user_id",l),e.props.loadingStart(),N.a.post("help-ticket/list",a).then((function(t){var a=t.data.data?t.data.data:[],n=t.data.data?t.data.data:[];e.setState({statusCount:a,ticketCount:n}),e.props.loadingStop()})).catch((function(t){e.props.loadingStop(),e.setState({statusCount:[]})}))},e.ticketDetails=function(t,a){e.setState({ticketId:t,viewTicket:!0,selectedTicket:a})},e.updateViewTicket=function(){var t=e.state.viewTicket;e.setState({viewTicket:!t}),e.getTickets(1)},e}return Object(c.a)(a,[{key:"changePlaceHoldClassAdd",value:function(e){e.target.parentElement.classList.add("active")}},{key:"changePlaceHoldClassRemove",value:function(e){var t=e.target.parentElement;0===e.target.value.length&&t.classList.remove("active")}},{key:"componentDidMount",value:function(){this.getTickets(1)}},{key:"render",value:function(){var e,t=this.state,a=t.ticketCount,n=t.ticketId,c=t.viewTicket;a.length,this.renderShowsTotal;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"contBox m-b-45 tickedTable"},1==c?i.a.createElement(x,{ticketId:n,selectedTicket:this.state.selectedTicket,updateViewTicket:this.updateViewTicket}):i.a.createElement(j.BootstrapTable,{ref:"table",data:a,pagination:!0,headerStyle:{background:"#85c0ff"},striped:!0,hover:!0,condensed:!0,wrapperClasses:"table-responsive",className:"ticketTable"},i.a.createElement(j.TableHeaderColumn,{filter:{type:"TextFilter"},width:"100px",dataField:"ticket_no",isKey:!0,dataFormat:(e=this,function(t,a,n){return i.a.createElement(I.a,{tooltip:"Show Ticket",href:"#",clicked:function(){return e.ticketDetails(a.ticketid_Internal,a)},id:"tooltip-1"},a.ticket_no)})},"Ticket No."),i.a.createElement(j.TableHeaderColumn,{filter:{type:"TextFilter"},width:"100px",dataField:"status",tdStyle:{whiteSpace:"normal"}},"Status"),i.a.createElement(j.TableHeaderColumn,{filter:{type:"TextFilter"},width:"100px",dataField:"area"},"Subject"),i.a.createElement(j.TableHeaderColumn,{filter:{type:"TextFilter"},width:"120px",dataField:"created_at",dataFormat:function(e){return p()(e).format("DD/MM/YYYY hh:mm A")},tdStyle:{whiteSpace:"normal"}},"Date Logged"),i.a.createElement(j.TableHeaderColumn,{width:"100px",dataField:"id",dataFormat:Y(this)}))))}}]),a}(s.Component);t.default=Object(k.b)((function(e){return{loading:e.loader.loading}}),(function(e){return{loadingStart:function(){return e(Object(b.a)())},loadingStop:function(){return e(Object(b.b)())}}}))(A)},920:function(e,t,a){"use strict";var n=a(0),c=a.n(n),r=a(912),l=a(909),s=a(39);t.a=function(e){var t=e.id,a=e.children,n=e.href,i=e.tooltip,o=e.clicked;return c.a.createElement(r.a,{overlay:c.a.createElement(l.a,{id:t},i),placement:"top",delayShow:300,delayHide:150,trigger:["hover","focus"]},c.a.createElement(s.b,{to:n,onClick:o},a))}},983:function(e,t){}}]);